Submitting job: /common/home/users/d/dh.huang.2023/code/novel-translation/tune.sh
Current Directory:
/common/home/users/d/dh.huang.2023/code/novel-translation
Wed Jun 19 23:19:09 2024       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.129.03             Driver Version: 535.129.03   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A40                     On  | 00000000:C1:00.0 Off |                    0 |
|  0%   29C    P8              23W / 300W |      4MiB / 46068MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
Linux avenue 4.18.0-513.9.1.el8_9.x86_64 #1 SMP Wed Nov 29 18:55:19 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux
NAME="Rocky Linux"
VERSION="8.9 (Green Obsidian)"
ID="rocky"
ID_LIKE="rhel centos fedora"
VERSION_ID="8.9"
PLATFORM_ID="platform:el8"
PRETTY_NAME="Rocky Linux 8.9 (Green Obsidian)"
ANSI_COLOR="0;32"
LOGO="fedora-logo-icon"
CPE_NAME="cpe:/o:rocky:rocky:8:GA"
HOME_URL="https://rockylinux.org/"
BUG_REPORT_URL="https://bugs.rockylinux.org/"
SUPPORT_END="2029-05-31"
ROCKY_SUPPORT_PRODUCT="Rocky-Linux-8"
ROCKY_SUPPORT_PRODUCT_VERSION="8.9"
REDHAT_SUPPORT_PRODUCT="Rocky Linux"
REDHAT_SUPPORT_PRODUCT_VERSION="8.9"
Architecture:        x86_64
CPU op-mode(s):      32-bit, 64-bit
Byte Order:          Little Endian
CPU(s):              128
On-line CPU(s) list: 0-127
Thread(s) per core:  2
Core(s) per socket:  64
Socket(s):           1
NUMA node(s):        1
Vendor ID:           AuthenticAMD
CPU family:          25
Model:               1
Model name:          AMD EPYC 7763 64-Core Processor
Stepping:            1
CPU MHz:             2450.000
CPU max MHz:         3529.0520
CPU min MHz:         1500.0000
BogoMIPS:            4890.89
Virtualization:      AMD-V
L1d cache:           32K
L1i cache:           32K
L2 cache:            512K
L3 cache:            32768K
NUMA node0 CPU(s):   0-127
Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm constant_tsc rep_good nopl nonstop_tsc cpuid extd_apicid aperfmperf pni pclmulqdq monitor ssse3 fma cx16 pcid sse4_1 sse4_2 movbe popcnt aes xsave avx f16c rdrand lahf_lm cmp_legacy svm extapic cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw ibs skinit wdt tce topoext perfctr_core perfctr_nb bpext perfctr_llc mwaitx cpb cat_l3 cdp_l3 invpcid_single hw_pstate ssbd mba ibrs ibpb stibp vmmcall fsgsbase bmi1 avx2 smep bmi2 erms invpcid cqm rdt_a rdseed adx smap clflushopt clwb sha_ni xsaveopt xsavec xgetbv1 xsaves cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local clzero irperf xsaveerptr wbnoinvd amd_ppin brs arat npt lbrv svm_lock nrip_save tsc_scale vmcb_clean flushbyasid decodeassists pausefilter pfthreshold v_vmsave_vmload vgif v_spec_ctrl umip pku ospke vaes vpclmulqdq rdpid overflow_recov succor smca fsrm
MemTotal:       527658640 kB
Tuning unsloth/Qwen2-7B-Instruct-bnb-4bit
[nltk_data] Downloading package wordnet to
[nltk_data]     /common/home/users/d/dh.huang.2023/nltk_data...
[nltk_data]   Package wordnet is already up-to-date!
[nltk_data] Downloading package punkt to
[nltk_data]     /common/home/users/d/dh.huang.2023/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package omw-1.4 to
[nltk_data]     /common/home/users/d/dh.huang.2023/nltk_data...
[nltk_data]   Package omw-1.4 is already up-to-date!
ðŸ¦¥ Unsloth: Will patch your computer to enable 2x faster free finetuning.
loading env vars from: /common2/dh.huang.2023/code/novel-translation/.env
unsloth/Qwen2-7B-Instruct-bnb-4bit True models/Qwen2-7B-Instruct-bnb-4bit-MAC- Qwen2-7B-Instruct-bnb-4bit-MAC- 2048 10 None datasets/mac/mac.tsv results/mac-results.csv False True True
(1) GPU = NVIDIA A40. Max memory = 44.352 GB.
0.0 GB of memory reserved.
==((====))==  Unsloth: Fast Qwen2 patching release 2024.6
   \\   /|    GPU: NVIDIA A40. Max memory: 44.352 GB. Platform = Linux.
O^O/ \_/ \    Pytorch: 2.2.1+cu121. CUDA = 8.6. CUDA Toolkit = 12.1.
\        /    Bfloat16 = TRUE. Xformers = 0.0.25. FA = True.
 "-____-"     Free Apache license: http://github.com/unslothai/unsloth
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:11<00:35, 11.97s/it]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:22<00:22, 11.18s/it]Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:34<00:11, 11.30s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:44<00:00, 10.98s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:44<00:00, 11.13s/it]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
==((====))==  Unsloth - 2x faster free finetuning | Num GPUs = 1
   \\   /|    Num examples = 4,528 | Num Epochs = 10
O^O/ \_/ \    Batch size per device = 1 | Gradient Accumulation steps = 1
\        /    Total batch size = 1 | Total steps = 45,280
 "-____-"     Number of trainable parameters = 7,070,619,136
(2) GPU = NVIDIA A40. Max memory = 44.352 GB.
14.631 GB of memory reserved.
loading train/test data files
DatasetDict({
    train: Dataset({
        features: ['chinese', 'english', 'text', 'prompt'],
        num_rows: 4528
    })
    test: Dataset({
        features: ['chinese', 'english', 'text', 'prompt'],
        num_rows: 1133
    })
})
(3) GPU = NVIDIA A40. Max memory = 44.352 GB.
14.631 GB of memory reserved.
(4) GPU = NVIDIA A40. Max memory = 44.352 GB.
14.631 GB of memory reserved.
  0%|          | 0/45280 [00:00<?, ?it/s]  0%|          | 1/45280 [00:02<30:55:27,  2.46s/it]  0%|          | 2/45280 [00:03<17:49:23,  1.42s/it]  0%|          | 3/45280 [00:03<13:36:18,  1.08s/it]  0%|          | 4/45280 [00:04<12:25:22,  1.01it/s]  0%|          | 5/45280 [00:05<11:04:05,  1.14it/s]  0%|          | 6/45280 [00:06<10:15:17,  1.23it/s]  0%|          | 7/45280 [00:06<9:42:40,  1.29it/s]   0%|          | 8/45280 [00:07<9:21:21,  1.34it/s]  0%|          | 9/45280 [00:08<9:09:07,  1.37it/s]  0%|          | 10/45280 [00:08<8:59:40,  1.40it/s]  0%|          | 11/45280 [00:09<8:52:04,  1.42it/s]  0%|          | 12/45280 [00:10<8:47:41,  1.43it/s]  0%|          | 13/45280 [00:10<8:50:32,  1.42it/s]  0%|          | 14/45280 [00:11<8:47:36,  1.43it/s]  0%|          | 15/45280 [00:12<8:44:02,  1.44it/s]  0%|          | 16/45280 [00:12<8:43:30,  1.44it/s]  0%|          | 17/45280 [00:13<8:40:58,  1.45it/s]  0%|          | 18/45280 [00:14<8:40:41,  1.45it/s]  0%|          | 19/45280 [00:14<8:37:58,  1.46it/s]  0%|          | 20/45280 [00:15<8:36:12,  1.46it/s]  0%|          | 21/45280 [00:16<8:36:58,  1.46it/s]  0%|          | 22/45280 [00:17<8:37:04,  1.46it/s]  0%|          | 23/45280 [00:17<8:36:48,  1.46it/s]  0%|          | 24/45280 [00:18<8:37:53,  1.46it/s]  0%|          | 25/45280 [00:19<8:36:49,  1.46it/s]  0%|          | 26/45280 [00:19<8:38:01,  1.46it/s]  0%|          | 27/45280 [00:20<8:37:18,  1.46it/s]  0%|          | 28/45280 [00:21<8:36:44,  1.46it/s]  0%|          | 29/45280 [00:21<8:36:03,  1.46it/s]  0%|          | 30/45280 [00:22<8:37:11,  1.46it/s]  0%|          | 31/45280 [00:23<8:38:04,  1.46it/s]  0%|          | 32/45280 [00:23<8:37:53,  1.46it/s]  0%|          | 33/45280 [00:24<8:38:34,  1.45it/s]  0%|          | 34/45280 [00:25<8:37:26,  1.46it/s]  0%|          | 35/45280 [00:25<8:38:25,  1.45it/s]  0%|          | 36/45280 [00:26<8:36:58,  1.46it/s]  0%|          | 37/45280 [00:27<8:36:49,  1.46it/s]  0%|          | 38/45280 [00:28<8:38:00,  1.46it/s]  0%|          | 39/45280 [00:28<8:37:43,  1.46it/s]  0%|          | 40/45280 [00:29<8:36:31,  1.46it/s]  0%|          | 41/45280 [00:30<8:36:26,  1.46it/s]  0%|          | 42/45280 [00:30<8:35:24,  1.46it/s]  0%|          | 43/45280 [00:31<8:35:16,  1.46it/s]  0%|          | 44/45280 [00:32<8:35:01,  1.46it/s]  0%|          | 45/45280 [00:32<8:37:41,  1.46it/s]  0%|          | 46/45280 [00:33<8:37:48,  1.46it/s]  0%|          | 47/45280 [00:34<8:36:48,  1.46it/s]  0%|          | 48/45280 [00:34<8:35:50,  1.46it/s]  0%|          | 49/45280 [00:35<8:35:52,  1.46it/s]  0%|          | 50/45280 [00:36<9:12:38,  1.36it/s]  0%|          | 51/45280 [00:37<9:03:03,  1.39it/s]  0%|          | 52/45280 [00:37<8:56:00,  1.41it/s]  0%|          | 53/45280 [00:38<8:49:59,  1.42it/s]  0%|          | 54/45280 [00:39<8:45:51,  1.43it/s]  0%|          | 55/45280 [00:39<8:43:31,  1.44it/s]  0%|          | 56/45280 [00:40<8:41:51,  1.44it/s]  0%|          | 57/45280 [00:41<8:40:18,  1.45it/s]  0%|          | 58/45280 [00:41<8:40:13,  1.45it/s]  0%|          | 59/45280 [00:42<8:39:30,  1.45it/s]  0%|          | 60/45280 [00:43<8:38:25,  1.45it/s]  0%|          | 61/45280 [00:43<8:37:30,  1.46it/s]  0%|          | 62/45280 [00:44<8:38:03,  1.45it/s]  0%|          | 63/45280 [00:45<8:37:32,  1.46it/s]  0%|          | 64/45280 [00:46<8:36:51,  1.46it/s]  0%|          | 65/45280 [00:46<8:37:04,  1.46it/s]  0%|          | 66/45280 [00:47<8:37:52,  1.46it/s]  0%|          | 67/45280 [00:48<8:37:11,  1.46it/s]  0%|          | 68/45280 [00:48<8:37:28,  1.46it/s]  0%|          | 69/45280 [00:49<8:36:05,  1.46it/s]  0%|          | 70/45280 [00:50<8:35:36,  1.46it/s]  0%|          | 71/45280 [00:50<8:35:45,  1.46it/s]  0%|          | 72/45280 [00:51<8:36:40,  1.46it/s]  0%|          | 73/45280 [00:52<8:37:22,  1.46it/s]  0%|          | 74/45280 [00:52<8:37:42,  1.46it/s]  0%|          | 75/45280 [00:53<8:37:53,  1.45it/s]  0%|          | 76/45280 [00:54<8:37:50,  1.45it/s]  0%|          | 77/45280 [00:54<8:37:45,  1.46it/s]  0%|          | 78/45280 [00:55<8:38:01,  1.45it/s]  0%|          | 79/45280 [00:56<8:38:23,  1.45it/s]  0%|          | 80/45280 [00:57<8:36:45,  1.46it/s]  0%|          | 81/45280 [00:57<8:37:33,  1.46it/s]  0%|          | 82/45280 [00:58<8:38:36,  1.45it/s]  0%|          | 83/45280 [00:59<8:37:48,  1.45it/s]  0%|          | 84/45280 [00:59<8:35:34,  1.46it/s]  0%|          | 85/45280 [01:00<8:36:28,  1.46it/s]  0%|          | 86/45280 [01:01<8:36:17,  1.46it/s]  0%|          | 87/45280 [01:01<8:37:03,  1.46it/s]  0%|          | 88/45280 [01:02<8:37:03,  1.46it/s]  0%|          | 89/45280 [01:03<8:37:35,  1.46it/s]  0%|          | 90/45280 [01:03<8:36:44,  1.46it/s]  0%|          | 91/45280 [01:04<8:35:34,  1.46it/s]  0%|          | 92/45280 [01:05<8:35:25,  1.46it/s]  0%|          | 93/45280 [01:05<8:35:59,  1.46it/s]  0%|          | 94/45280 [01:06<8:36:30,  1.46it/s]  0%|          | 95/45280 [01:07<8:36:34,  1.46it/s]  0%|          | 96/45280 [01:07<8:36:38,  1.46it/s]  0%|          | 97/45280 [01:08<8:35:05,  1.46it/s]  0%|          | 98/45280 [01:09<8:36:23,  1.46it/s]  0%|          | 99/45280 [01:10<8:36:55,  1.46it/s]  0%|          | 100/45280 [01:10<8:37:25,  1.46it/s]                                                       0%|          | 100/45280 [01:10<8:37:25,  1.46it/s]  0%|          | 101/45280 [01:11<8:40:59,  1.45it/s]  0%|          | 102/45280 [01:12<8:39:09,  1.45it/s]  0%|          | 103/45280 [01:12<8:40:44,  1.45it/s]  0%|          | 104/45280 [01:13<8:39:15,  1.45it/s]  0%|          | 105/45280 [01:14<8:37:56,  1.45it/s]  0%|          | 106/45280 [01:14<8:37:56,  1.45it/s]  0%|          | 107/45280 [01:15<8:37:47,  1.45it/s]  0%|          | 108/45280 [01:16<8:37:05,  1.46it/s]  0%|          | 109/45280 [01:16<8:38:08,  1.45it/s]  0%|          | 110/45280 [01:17<8:38:12,  1.45it/s]  0%|          | 111/45280 [01:18<8:37:36,  1.45it/s]  0%|          | 112/45280 [01:18<8:37:33,  1.45it/s]  0%|          | 113/45280 [01:19<8:37:06,  1.46it/s]  0%|          | 114/45280 [01:20<8:37:13,  1.46it/s]  0%|          | 115/45280 [01:21<8:36:50,  1.46it/s]  0%|          | 116/45280 [01:21<8:36:18,  1.46it/s]  0%|          | 117/45280 [01:22<8:37:10,  1.46it/s]  0%|          | 118/45280 [01:23<8:36:51,  1.46it/s]  0%|          | 119/45280 [01:23<8:36:39,  1.46it/s]  0%|          | 120/45280 [01:24<8:36:01,  1.46it/s]  0%|          | 121/45280 [01:25<8:35:18,  1.46it/s]  0%|          | 122/45280 [01:25<8:35:27,  1.46it/s]  0%|          | 123/45280 [01:26<8:35:36,  1.46it/s]  0%|          | 124/45280 [01:27<8:35:42,  1.46it/s]  0%|          | 125/45280 [01:27<8:37:23,  1.45it/s]  0%|          | 126/45280 [01:28<8:37:47,  1.45it/s]  0%|          | 127/45280 [01:29<8:38:14,  1.45it/s]  0%|          | 128/45280 [01:29<8:38:00,  1.45it/s]  0%|          | 129/45280 [01:30<8:36:55,  1.46it/s]  0%|          | 130/45280 [01:31<8:37:09,  1.46it/s]  0%|          | 131/45280 [01:32<8:36:39,  1.46it/s]  0%|          | 132/45280 [01:32<8:35:27,  1.46it/s]  0%|          | 133/45280 [01:33<8:36:17,  1.46it/s]  0%|          | 134/45280 [01:34<8:36:03,  1.46it/s]  0%|          | 135/45280 [01:34<8:36:48,  1.46it/s]  0%|          | 136/45280 [01:35<8:35:05,  1.46it/s]  0%|          | 137/45280 [01:36<8:37:26,  1.45it/s]  0%|          | 138/45280 [01:36<8:37:36,  1.45it/s]  0%|          | 139/45280 [01:37<8:37:40,  1.45it/s]  0%|          | 140/45280 [01:38<8:37:54,  1.45it/s]  0%|          | 141/45280 [01:38<8:38:05,  1.45it/s]  0%|          | 142/45280 [01:39<8:36:41,  1.46it/s]  0%|          | 143/45280 [01:40<8:35:37,  1.46it/s]  0%|          | 144/45280 [01:40<8:36:42,  1.46it/s]  0%|          | 145/45280 [01:41<8:35:58,  1.46it/s]  0%|          | 146/45280 [01:42<8:36:56,  1.46it/s]  0%|          | 147/45280 [01:43<8:37:31,  1.45it/s]  0%|          | 148/45280 [01:43<8:37:20,  1.45it/s]  0%|          | 149/45280 [01:44<8:38:11,  1.45it/s]  0%|          | 150/45280 [01:45<8:38:14,  1.45it/s]  0%|          | 151/45280 [01:45<8:38:24,  1.45it/s]  0%|          | 152/45280 [01:46<8:38:03,  1.45it/s]  0%|          | 153/45280 [01:47<8:36:49,  1.46it/s]  0%|          | 154/45280 [01:47<8:39:25,  1.45it/s]  0%|          | 155/45280 [01:48<8:39:23,  1.45it/s]  0%|          | 156/45280 [01:49<8:37:20,  1.45it/s]  0%|          | 157/45280 [01:49<8:35:20,  1.46it/s]  0%|          | 158/45280 [01:50<8:36:51,  1.46it/s]  0%|          | 159/45280 [01:51<8:37:02,  1.45it/s]  0%|          | 160/45280 [01:51<8:37:47,  1.45it/s]  0%|          | 161/45280 [01:52<8:37:33,  1.45it/s]  0%|          | 162/45280 [01:53<8:38:04,  1.45it/s]  0%|          | 163/45280 [01:54<8:37:28,  1.45it/s]  0%|          | 164/45280 [01:54<8:36:39,  1.46it/s]  0%|          | 165/45280 [01:55<8:36:55,  1.45it/s]  0%|          | 166/45280 [01:56<8:37:17,  1.45it/s]  0%|          | 167/45280 [01:56<8:37:24,  1.45it/s]  0%|          | 168/45280 [01:57<8:37:51,  1.45it/s]  0%|          | 169/45280 [01:58<8:37:16,  1.45it/s]  0%|          | 170/45280 [01:58<8:37:11,  1.45it/s]  0%|          | 171/45280 [01:59<8:36:26,  1.46it/s]  0%|          | 172/45280 [02:00<8:37:15,  1.45it/s]  0%|          | 173/45280 [02:00<8:36:46,  1.45it/s]  0%|          | 174/45280 [02:01<8:36:11,  1.46it/s]  0%|          | 175/45280 [02:02<8:36:25,  1.46it/s]  0%|          | 176/45280 [02:02<8:35:57,  1.46it/s]  0%|          | 177/45280 [02:03<8:36:02,  1.46it/s]  0%|          | 178/45280 [02:04<8:36:26,  1.46it/s]  0%|          | 179/45280 [02:05<8:36:19,  1.46it/s]  0%|          | 180/45280 [02:05<8:36:58,  1.45it/s]  0%|          | 181/45280 [02:06<8:37:05,  1.45it/s]  0%|          | 182/45280 [02:07<8:36:52,  1.45it/s]  0%|          | 183/45280 [02:07<8:37:00,  1.45it/s]  0%|          | 184/45280 [02:08<8:36:00,  1.46it/s]  0%|          | 185/45280 [02:09<8:36:49,  1.45it/s]  0%|          | 186/45280 [02:09<8:35:25,  1.46it/s]  0%|          | 187/45280 [02:10<8:36:07,  1.46it/s]  0%|          | 188/45280 [02:11<8:36:21,  1.46it/s]  0%|          | 189/45280 [02:11<8:37:18,  1.45it/s]  0%|          | 190/45280 [02:12<8:36:02,  1.46it/s]  0%|          | 191/45280 [02:13<8:38:08,  1.45it/s]  0%|          | 192/45280 [02:13<8:37:05,  1.45it/s]  0%|          | 193/45280 [02:14<8:35:30,  1.46it/s]  0%|          | 194/45280 [02:15<8:35:42,  1.46it/s]  0%|          | 195/45280 [02:16<8:35:13,  1.46it/s]  0%|          | 196/45280 [02:16<8:35:47,  1.46it/s]  0%|          | 197/45280 [02:17<8:35:46,  1.46it/s]  0%|          | 198/45280 [02:18<8:36:19,  1.46it/s]  0%|          | 199/45280 [02:18<8:36:40,  1.45it/s]  0%|          | 200/45280 [02:19<8:36:35,  1.45it/s]                                                       0%|          | 200/45280 [02:19<8:36:35,  1.45it/s]  0%|          | 201/45280 [02:20<8:36:33,  1.45it/s]  0%|          | 202/45280 [02:20<8:35:49,  1.46it/s]  0%|          | 203/45280 [02:21<8:34:51,  1.46it/s]  0%|          | 204/45280 [02:22<8:35:11,  1.46it/s]  0%|          | 205/45280 [02:22<8:35:56,  1.46it/s]  0%|          | 206/45280 [02:23<8:36:50,  1.45it/s]  0%|          | 207/45280 [02:24<8:36:43,  1.45it/s]  0%|          | 208/45280 [02:24<8:35:58,  1.46it/s]  0%|          | 209/45280 [02:25<8:37:18,  1.45it/s]  0%|          | 210/45280 [02:26<8:36:13,  1.46it/s]  0%|          | 211/45280 [02:27<8:36:22,  1.45it/s]  0%|          | 212/45280 [02:27<8:36:36,  1.45it/s]  0%|          | 213/45280 [02:28<8:36:13,  1.46it/s]  0%|          | 214/45280 [02:29<8:36:41,  1.45it/s]  0%|          | 215/45280 [02:29<8:36:41,  1.45it/s]  0%|          | 216/45280 [02:30<8:36:07,  1.46it/s]  0%|          | 217/45280 [02:31<8:36:28,  1.45it/s]  0%|          | 218/45280 [02:31<8:36:48,  1.45it/s]  0%|          | 219/45280 [02:32<8:35:57,  1.46it/s]  0%|          | 220/45280 [02:33<8:36:25,  1.45it/s]  0%|          | 221/45280 [02:33<8:36:34,  1.45it/s]  0%|          | 222/45280 [02:34<8:35:43,  1.46it/s]  0%|          | 223/45280 [02:35<8:34:52,  1.46it/s]  0%|          | 224/45280 [02:35<8:35:49,  1.46it/s]  0%|          | 225/45280 [02:36<8:35:39,  1.46it/s]  0%|          | 226/45280 [02:37<8:36:24,  1.45it/s]  1%|          | 227/45280 [02:38<8:36:02,  1.46it/s]  1%|          | 228/45280 [02:38<8:36:00,  1.46it/s]  1%|          | 229/45280 [02:39<8:36:03,  1.45it/s]  1%|          | 230/45280 [02:40<8:36:45,  1.45it/s]  1%|          | 231/45280 [02:40<8:36:16,  1.45it/s]  1%|          | 232/45280 [02:41<8:36:23,  1.45it/s]  1%|          | 233/45280 [02:42<8:36:16,  1.45it/s]  1%|          | 234/45280 [02:42<8:38:49,  1.45it/s]  1%|          | 235/45280 [02:43<8:37:56,  1.45it/s]  1%|          | 236/45280 [02:44<8:38:00,  1.45it/s]  1%|          | 237/45280 [02:44<8:36:28,  1.45it/s]  1%|          | 238/45280 [02:45<8:37:08,  1.45it/s]  1%|          | 239/45280 [02:46<8:36:58,  1.45it/s]  1%|          | 240/45280 [02:46<8:38:33,  1.45it/s]  1%|          | 241/45280 [02:47<8:36:56,  1.45it/s]  1%|          | 242/45280 [02:48<8:37:28,  1.45it/s]  1%|          | 243/45280 [02:49<8:36:29,  1.45it/s]  1%|          | 244/45280 [02:49<8:36:24,  1.45it/s]  1%|          | 245/45280 [02:50<8:36:30,  1.45it/s]  1%|          | 246/45280 [02:51<8:37:24,  1.45it/s]  1%|          | 247/45280 [02:51<8:36:24,  1.45it/s]  1%|          | 248/45280 [02:52<8:36:08,  1.45it/s]  1%|          | 249/45280 [02:53<8:36:28,  1.45it/s]  1%|          | 250/45280 [02:53<8:35:30,  1.46it/s]  1%|          | 251/45280 [02:54<8:34:36,  1.46it/s]  1%|          | 252/45280 [02:55<8:35:03,  1.46it/s]  1%|          | 253/45280 [02:55<8:35:47,  1.45it/s]  1%|          | 254/45280 [02:56<8:36:46,  1.45it/s]  1%|          | 255/45280 [02:57<8:36:22,  1.45it/s]  1%|          | 256/45280 [02:57<8:36:16,  1.45it/s]  1%|          | 257/45280 [02:58<8:35:53,  1.45it/s]  1%|          | 258/45280 [02:59<8:35:39,  1.46it/s]  1%|          | 259/45280 [03:00<8:35:55,  1.45it/s]  1%|          | 260/45280 [03:00<8:36:20,  1.45it/s]  1%|          | 261/45280 [03:01<8:36:12,  1.45it/s]  1%|          | 262/45280 [03:02<8:36:28,  1.45it/s]  1%|          | 263/45280 [03:02<8:36:17,  1.45it/s]  1%|          | 264/45280 [03:03<8:35:18,  1.46it/s]  1%|          | 265/45280 [03:04<8:34:55,  1.46it/s]  1%|          | 266/45280 [03:04<8:36:03,  1.45it/s]  1%|          | 267/45280 [03:05<8:36:15,  1.45it/s]  1%|          | 268/45280 [03:06<8:36:24,  1.45it/s]  1%|          | 269/45280 [03:06<8:36:30,  1.45it/s]  1%|          | 270/45280 [03:07<8:34:42,  1.46it/s]  1%|          | 271/45280 [03:08<8:36:38,  1.45it/s]  1%|          | 272/45280 [03:08<8:36:11,  1.45it/s]  1%|          | 273/45280 [03:09<8:35:55,  1.45it/s]  1%|          | 274/45280 [03:10<8:35:41,  1.45it/s]  1%|          | 275/45280 [03:11<8:35:18,  1.46it/s]  1%|          | 276/45280 [03:11<8:35:09,  1.46it/s]  1%|          | 277/45280 [03:12<8:35:49,  1.45it/s]  1%|          | 278/45280 [03:13<8:35:30,  1.45it/s]  1%|          | 279/45280 [03:13<8:35:35,  1.45it/s]  1%|          | 280/45280 [03:14<8:35:08,  1.46it/s]  1%|          | 281/45280 [03:15<8:35:19,  1.46it/s]  1%|          | 282/45280 [03:15<8:38:21,  1.45it/s]  1%|          | 283/45280 [03:16<8:41:03,  1.44it/s]  1%|          | 284/45280 [03:17<8:39:25,  1.44it/s]  1%|          | 285/45280 [03:17<8:38:44,  1.45it/s]  1%|          | 286/45280 [03:18<8:36:54,  1.45it/s]  1%|          | 287/45280 [03:19<8:35:54,  1.45it/s]  1%|          | 288/45280 [03:20<8:36:37,  1.45it/s]  1%|          | 289/45280 [03:20<8:35:34,  1.45it/s]  1%|          | 290/45280 [03:21<8:35:23,  1.45it/s]  1%|          | 291/45280 [03:22<8:35:51,  1.45it/s]  1%|          | 292/45280 [03:22<8:34:53,  1.46it/s]  1%|          | 293/45280 [03:23<8:35:28,  1.45it/s]  1%|          | 294/45280 [03:24<8:35:10,  1.46it/s]  1%|          | 295/45280 [03:24<8:35:46,  1.45it/s]  1%|          | 296/45280 [03:25<8:35:27,  1.45it/s]  1%|          | 297/45280 [03:26<8:34:51,  1.46it/s]  1%|          | 298/45280 [03:26<8:33:52,  1.46it/s]  1%|          | 299/45280 [03:27<8:34:57,  1.46it/s]  1%|          | 300/45280 [03:28<8:36:02,  1.45it/s]                                                       1%|          | 300/45280 [03:28<8:36:02,  1.45it/s]  1%|          | 301/45280 [03:28<8:35:24,  1.45it/s]  1%|          | 302/45280 [03:29<8:36:08,  1.45it/s]  1%|          | 303/45280 [03:30<8:35:38,  1.45it/s]  1%|          | 304/45280 [03:31<8:34:52,  1.46it/s]  1%|          | 305/45280 [03:31<8:35:23,  1.45it/s]  1%|          | 306/45280 [03:32<8:35:49,  1.45it/s]  1%|          | 307/45280 [03:33<8:36:24,  1.45it/s]  1%|          | 308/45280 [03:33<8:35:16,  1.45it/s]  1%|          | 309/45280 [03:34<8:36:13,  1.45it/s]  1%|          | 310/45280 [03:35<8:36:22,  1.45it/s]  1%|          | 311/45280 [03:35<8:36:38,  1.45it/s]  1%|          | 312/45280 [03:36<8:36:44,  1.45it/s]  1%|          | 313/45280 [03:37<8:34:54,  1.46it/s]  1%|          | 314/45280 [03:37<8:36:29,  1.45it/s]  1%|          | 315/45280 [03:38<8:35:39,  1.45it/s]  1%|          | 316/45280 [03:39<8:35:47,  1.45it/s]  1%|          | 317/45280 [03:39<8:35:32,  1.45it/s]  1%|          | 318/45280 [03:40<8:33:46,  1.46it/s]  1%|          | 319/45280 [03:41<8:35:37,  1.45it/s]  1%|          | 320/45280 [03:42<8:35:39,  1.45it/s]  1%|          | 321/45280 [03:42<8:36:10,  1.45it/s]  1%|          | 322/45280 [03:43<8:35:41,  1.45it/s]  1%|          | 323/45280 [03:44<8:35:50,  1.45it/s]  1%|          | 324/45280 [03:44<8:35:46,  1.45it/s]  1%|          | 325/45280 [03:45<8:33:34,  1.46it/s]  1%|          | 326/45280 [03:46<8:33:57,  1.46it/s]  1%|          | 327/45280 [03:46<8:33:30,  1.46it/s]  1%|          | 328/45280 [03:47<8:34:51,  1.46it/s]  1%|          | 329/45280 [03:48<8:34:39,  1.46it/s]  1%|          | 330/45280 [03:48<8:35:32,  1.45it/s]  1%|          | 331/45280 [03:49<8:34:52,  1.46it/s]  1%|          | 332/45280 [03:50<8:33:22,  1.46it/s]  1%|          | 333/45280 [03:50<8:35:37,  1.45it/s]  1%|          | 334/45280 [03:51<8:34:41,  1.46it/s]  1%|          | 335/45280 [03:52<8:35:21,  1.45it/s]  1%|          | 336/45280 [03:53<8:35:27,  1.45it/s]  1%|          | 337/45280 [03:53<8:34:35,  1.46it/s]  1%|          | 338/45280 [03:54<8:34:41,  1.46it/s]  1%|          | 339/45280 [03:55<8:35:51,  1.45it/s]  1%|          | 340/45280 [03:55<8:35:46,  1.45it/s]  1%|          | 341/45280 [03:56<8:35:17,  1.45it/s]  1%|          | 342/45280 [03:57<8:35:27,  1.45it/s]  1%|          | 343/45280 [03:57<8:37:21,  1.45it/s]  1%|          | 344/45280 [03:58<8:36:52,  1.45it/s]  1%|          | 345/45280 [03:59<8:36:09,  1.45it/s]  1%|          | 346/45280 [03:59<8:35:03,  1.45it/s]  1%|          | 347/45280 [04:00<8:33:47,  1.46it/s]  1%|          | 348/45280 [04:01<8:34:47,  1.45it/s]  1%|          | 349/45280 [04:01<8:32:51,  1.46it/s]  1%|          | 350/45280 [04:02<8:33:55,  1.46it/s]  1%|          | 351/45280 [04:03<8:34:32,  1.46it/s]  1%|          | 352/45280 [04:04<8:33:46,  1.46it/s]  1%|          | 353/45280 [04:04<8:35:06,  1.45it/s]  1%|          | 354/45280 [04:05<8:34:29,  1.46it/s]  1%|          | 355/45280 [04:06<8:35:16,  1.45it/s]  1%|          | 356/45280 [04:06<8:35:32,  1.45it/s]  1%|          | 357/45280 [04:07<8:34:34,  1.46it/s]  1%|          | 358/45280 [04:08<8:34:52,  1.45it/s]  1%|          | 359/45280 [04:08<8:34:17,  1.46it/s]  1%|          | 360/45280 [04:09<8:33:40,  1.46it/s]  1%|          | 361/45280 [04:10<8:33:47,  1.46it/s]  1%|          | 362/45280 [04:10<8:34:38,  1.45it/s]  1%|          | 363/45280 [04:11<8:35:42,  1.45it/s]  1%|          | 364/45280 [04:12<8:34:49,  1.45it/s]  1%|          | 365/45280 [04:12<8:35:29,  1.45it/s]  1%|          | 366/45280 [04:13<8:35:22,  1.45it/s]  1%|          | 367/45280 [04:14<8:35:30,  1.45it/s]  1%|          | 368/45280 [04:15<8:34:36,  1.45it/s]  1%|          | 369/45280 [04:15<8:35:12,  1.45it/s]  1%|          | 370/45280 [04:16<8:34:50,  1.45it/s]  1%|          | 371/45280 [04:17<8:35:21,  1.45it/s]  1%|          | 372/45280 [04:17<8:34:47,  1.45it/s]  1%|          | 373/45280 [04:18<8:35:02,  1.45it/s]  1%|          | 374/45280 [04:19<8:35:17,  1.45it/s]  1%|          | 375/45280 [04:19<8:35:23,  1.45it/s]  1%|          | 376/45280 [04:20<8:34:47,  1.45it/s]  1%|          | 377/45280 [04:21<8:34:45,  1.45it/s]  1%|          | 378/45280 [04:21<8:36:04,  1.45it/s]  1%|          | 379/45280 [04:22<8:36:42,  1.45it/s]  1%|          | 380/45280 [04:23<8:36:32,  1.45it/s]  1%|          | 381/45280 [04:23<8:36:02,  1.45it/s]  1%|          | 382/45280 [04:24<8:35:57,  1.45it/s]  1%|          | 383/45280 [04:25<8:35:11,  1.45it/s]  1%|          | 384/45280 [04:26<8:33:32,  1.46it/s]  1%|          | 385/45280 [04:26<8:33:29,  1.46it/s]  1%|          | 386/45280 [04:27<8:33:12,  1.46it/s]  1%|          | 387/45280 [04:28<8:34:07,  1.46it/s]  1%|          | 388/45280 [04:28<8:32:55,  1.46it/s]  1%|          | 389/45280 [04:29<8:31:32,  1.46it/s]  1%|          | 390/45280 [04:30<8:32:44,  1.46it/s]  1%|          | 391/45280 [04:30<8:33:34,  1.46it/s]  1%|          | 392/45280 [04:31<8:34:03,  1.46it/s]  1%|          | 393/45280 [04:32<8:34:54,  1.45it/s]  1%|          | 394/45280 [04:32<8:36:20,  1.45it/s]  1%|          | 395/45280 [04:33<8:35:28,  1.45it/s]  1%|          | 396/45280 [04:34<8:35:05,  1.45it/s]  1%|          | 397/45280 [04:34<8:32:57,  1.46it/s]  1%|          | 398/45280 [04:35<8:34:30,  1.45it/s]  1%|          | 399/45280 [04:36<8:34:24,  1.45it/s]  1%|          | 400/45280 [04:37<8:33:18,  1.46it/s]                                                       1%|          | 400/45280 [04:37<8:33:18,  1.46it/s]  1%|          | 401/45280 [04:37<8:34:13,  1.45it/s]  1%|          | 402/45280 [04:38<8:33:27,  1.46it/s]  1%|          | 403/45280 [04:39<8:33:49,  1.46it/s]  1%|          | 404/45280 [04:39<8:34:08,  1.45it/s]  1%|          | 405/45280 [04:40<8:34:25,  1.45it/s]  1%|          | 406/45280 [04:41<8:34:57,  1.45it/s]  1%|          | 407/45280 [04:41<8:35:01,  1.45it/s]  1%|          | 408/45280 [04:42<8:35:07,  1.45it/s]  1%|          | 409/45280 [04:43<8:35:06,  1.45it/s]  1%|          | 410/45280 [04:43<8:34:40,  1.45it/s]  1%|          | 411/45280 [04:44<8:35:04,  1.45it/s]  1%|          | 412/45280 [04:45<8:35:01,  1.45it/s]  1%|          | 413/45280 [04:45<8:34:15,  1.45it/s]  1%|          | 414/45280 [04:46<8:34:18,  1.45it/s]  1%|          | 415/45280 [04:47<8:34:10,  1.45it/s]  1%|          | 416/45280 [04:48<8:34:42,  1.45it/s]  1%|          | 417/45280 [04:48<8:35:25,  1.45it/s]  1%|          | 418/45280 [04:49<8:35:08,  1.45it/s]  1%|          | 419/45280 [04:50<8:35:12,  1.45it/s]  1%|          | 420/45280 [04:50<8:34:18,  1.45it/s]  1%|          | 421/45280 [04:51<8:32:55,  1.46it/s]  1%|          | 422/45280 [04:52<8:34:40,  1.45it/s]  1%|          | 423/45280 [04:52<8:36:36,  1.45it/s]  1%|          | 424/45280 [04:53<8:35:56,  1.45it/s]  1%|          | 425/45280 [04:54<8:34:22,  1.45it/s]  1%|          | 426/45280 [04:54<8:32:34,  1.46it/s]  1%|          | 427/45280 [04:55<8:34:07,  1.45it/s]  1%|          | 428/45280 [04:56<8:33:49,  1.45it/s]  1%|          | 429/45280 [04:56<8:33:29,  1.46it/s]  1%|          | 430/45280 [04:57<8:33:21,  1.46it/s]  1%|          | 431/45280 [04:58<8:34:15,  1.45it/s]  1%|          | 432/45280 [04:59<8:34:33,  1.45it/s]  1%|          | 433/45280 [04:59<8:34:26,  1.45it/s]  1%|          | 434/45280 [05:00<8:33:13,  1.46it/s]  1%|          | 435/45280 [05:01<8:33:58,  1.45it/s]  1%|          | 436/45280 [05:01<8:33:55,  1.45it/s]  1%|          | 437/45280 [05:02<8:32:04,  1.46it/s]  1%|          | 438/45280 [05:03<8:32:38,  1.46it/s]  1%|          | 439/45280 [05:03<8:33:37,  1.46it/s]  1%|          | 440/45280 [05:04<8:33:50,  1.45it/s]  1%|          | 441/45280 [05:05<8:33:50,  1.45it/s]  1%|          | 442/45280 [05:05<8:33:52,  1.45it/s]  1%|          | 443/45280 [05:06<8:33:46,  1.45it/s]  1%|          | 444/45280 [05:07<8:33:58,  1.45it/s]  1%|          | 445/45280 [05:07<8:34:22,  1.45it/s]  1%|          | 446/45280 [05:08<8:34:07,  1.45it/s]  1%|          | 447/45280 [05:09<8:33:00,  1.46it/s]  1%|          | 448/45280 [05:10<8:33:13,  1.46it/s]  1%|          | 449/45280 [05:10<8:33:24,  1.46it/s]  1%|          | 450/45280 [05:11<8:33:29,  1.46it/s]  1%|          | 451/45280 [05:12<8:32:57,  1.46it/s]  1%|          | 452/45280 [05:12<8:34:00,  1.45it/s]  1%|          | 453/45280 [05:13<8:34:26,  1.45it/s]  1%|          | 454/45280 [05:14<8:34:41,  1.45it/s]  1%|          | 455/45280 [05:14<8:34:22,  1.45it/s]  1%|          | 456/45280 [05:15<8:35:18,  1.45it/s]  1%|          | 457/45280 [05:16<8:34:37,  1.45it/s]  1%|          | 458/45280 [05:16<8:36:18,  1.45it/s]  1%|          | 459/45280 [05:17<8:35:34,  1.45it/s]  1%|          | 460/45280 [05:18<8:35:31,  1.45it/s]  1%|          | 461/45280 [05:18<8:33:28,  1.45it/s]  1%|          | 462/45280 [05:19<8:33:58,  1.45it/s]  1%|          | 463/45280 [05:20<8:32:50,  1.46it/s]  1%|          | 464/45280 [05:21<8:32:42,  1.46it/s]  1%|          | 465/45280 [05:21<8:33:13,  1.46it/s]  1%|          | 466/45280 [05:22<8:33:12,  1.46it/s]  1%|          | 467/45280 [05:23<8:33:59,  1.45it/s]  1%|          | 468/45280 [05:23<8:32:04,  1.46it/s]  1%|          | 469/45280 [05:24<8:32:26,  1.46it/s]  1%|          | 470/45280 [05:25<8:32:54,  1.46it/s]  1%|          | 471/45280 [05:25<8:33:34,  1.45it/s]  1%|          | 472/45280 [05:26<8:33:55,  1.45it/s]  1%|          | 473/45280 [05:27<8:33:17,  1.45it/s]  1%|          | 474/45280 [05:27<8:33:41,  1.45it/s]  1%|          | 475/45280 [05:28<8:32:41,  1.46it/s]  1%|          | 476/45280 [05:29<8:33:22,  1.45it/s]  1%|          | 477/45280 [05:29<8:32:56,  1.46it/s]  1%|          | 478/45280 [05:30<8:33:24,  1.45it/s]  1%|          | 479/45280 [05:31<8:33:17,  1.45it/s]  1%|          | 480/45280 [05:32<8:32:41,  1.46it/s]  1%|          | 481/45280 [05:32<8:33:39,  1.45it/s]  1%|          | 482/45280 [05:33<8:33:55,  1.45it/s]  1%|          | 483/45280 [05:34<8:33:58,  1.45it/s]  1%|          | 484/45280 [05:34<8:33:13,  1.45it/s]  1%|          | 485/45280 [05:35<8:33:38,  1.45it/s]  1%|          | 486/45280 [05:36<8:33:47,  1.45it/s]  {'loss': 4.7464, 'grad_norm': 12.375, 'learning_rate': 0.00019958034235229157, 'epoch': 0.02}
{'loss': 4.838, 'grad_norm': 12.0625, 'learning_rate': 0.00019913859745996688, 'epoch': 0.04}
{'loss': 4.3553, 'grad_norm': 8.3125, 'learning_rate': 0.00019869685256764219, 'epoch': 0.07}
{'loss': 4.7456, 'grad_norm': 23.5, 'learning_rate': 0.00019825510767531752, 'epoch': 0.09}
{'loss': 4.352, 'grad_norm': 11.1875, 'learning_rate': 0.00019781336278299283, 'epoch': 0.11}
1%|          | 487/45280 [05:36<8:32:52,  1.46it/s]  1%|          | 488/45280 [05:37<8:34:12,  1.45it/s]  1%|          | 489/45280 [05:38<8:32:25,  1.46it/s]  1%|          | 490/45280 [05:38<8:32:28,  1.46it/s]  1%|          | 491/45280 [05:39<8:33:16,  1.45it/s]  1%|          | 492/45280 [05:40<8:32:25,  1.46it/s]  1%|          | 493/45280 [05:40<8:32:45,  1.46it/s]  1%|          | 494/45280 [05:41<8:32:34,  1.46it/s]  1%|          | 495/45280 [05:42<8:33:15,  1.45it/s]  1%|          | 496/45280 [05:43<8:33:35,  1.45it/s]  1%|          | 497/45280 [05:43<8:34:19,  1.45it/s]  1%|          | 498/45280 [05:44<8:31:55,  1.46it/s]  1%|          | 499/45280 [05:45<8:32:44,  1.46it/s]  1%|          | 500/45280 [05:45<8:32:35,  1.46it/s]                                                       1%|          | 500/45280 [05:45<8:32:35,  1.46it/s]Traceback (most recent call last):
  File "/common2/dh.huang.2023/code/novel-translation/tune.py", line 115, in <module>
    trainer_stats = trainer.train()
                    ^^^^^^^^^^^^^^^
  File "<string>", line 123, in train
  File "<string>", line 359, in _fast_inner_training_loop
  File "/common/home/users/d/dh.huang.2023/.conda/envs/llm-perf-bench/lib/python3.11/site-packages/transformers/trainer.py", line 3238, in training_step
    loss = self.compute_loss(model, inputs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/common/home/users/d/dh.huang.2023/.conda/envs/llm-perf-bench/lib/python3.11/site-packages/transformers/trainer.py", line 3264, in compute_loss
    outputs = model(**inputs)
              ^^^^^^^^^^^^^^^
  File "/common/home/users/d/dh.huang.2023/.conda/envs/llm-perf-bench/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/common/home/users/d/dh.huang.2023/.conda/envs/llm-perf-bench/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/common/home/users/d/dh.huang.2023/.conda/envs/llm-perf-bench/lib/python3.11/site-packages/accelerate/utils/operations.py", line 825, in forward
    return model_forward(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/common/home/users/d/dh.huang.2023/.conda/envs/llm-perf-bench/lib/python3.11/site-packages/accelerate/utils/operations.py", line 813, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/common/home/users/d/dh.huang.2023/.conda/envs/llm-perf-bench/lib/python3.11/site-packages/torch/amp/autocast_mode.py", line 16, in decorate_autocast
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/common/home/users/d/dh.huang.2023/.conda/envs/llm-perf-bench/lib/python3.11/site-packages/unsloth/models/llama.py", line 820, in _CausalLM_fast_forward
    outputs = self.model(
              ^^^^^^^^^^^
  File "/common/home/users/d/dh.huang.2023/.conda/envs/llm-perf-bench/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/common/home/users/d/dh.huang.2023/.conda/envs/llm-perf-bench/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/common/home/users/d/dh.huang.2023/.conda/envs/llm-perf-bench/lib/python3.11/site-packages/unsloth/models/llama.py", line 547, in LlamaModel_fast_forward
    inputs_embeds = inputs_embeds.to(self.config.torch_dtype)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Invalid device string: 'bfloat16'
  1%|          | 500/45280 [06:42<10:00:09,  1.24it/s]
srun: error: avenue: task 0: Exited with exit code 1
srun: Terminating StepId=69297.0
Job ID: 69297
Cluster: crimson
User/Group: dh.huang.2023/dh.huang.2023
State: FAILED (exit code 1)
Nodes: 1
Cores per node: 10
CPU Utilized: 00:06:26
CPU Efficiency: 7.99% of 01:20:30 core-walltime
Job Wall-clock time: 00:08:03
Memory Utilized: 5.37 GB
Memory Efficiency: 2.10% of 256.00 GB
